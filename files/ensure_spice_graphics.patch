From 0347175d6d4246d890a2a38d3968840b1f5befbb Mon Sep 17 00:00:00 2001
From: Sam Ezeh <sam.z.ezeh@gmail.com>
Date: Fri, 24 Jun 2022 13:04:38 +0000
Subject: [PATCH] vm-configurator: Ensure spice graphics is specified in vm
 creation

Resolves #806
---
 src/vm-configurator.vala | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/src/vm-configurator.vala b/src/vm-configurator.vala
index 8e9f83f4..17720b59 100644
--- a/src/vm-configurator.vala
+++ b/src/vm-configurator.vala
@@ -91,10 +91,13 @@ public static Domain create_domain_config (InstallerMedia install_media, string
         set_target_media_config (domain, target_path, install_media);
         install_media.setup_domain_config (domain);
 
-        add_usb_support (domain, install_media);
+        if (SPICE_AVAILABLE) {
+            domain.add_device (create_graphics_device());
+            add_usb_support (domain, install_media);
 
-        if (!App.is_running_in_flatpak ())
-            add_smartcard_support (domain);
+            if (!App.is_running_in_flatpak ())
+                add_smartcard_support (domain);
+        }
 
         set_video_config (domain, install_media);
         set_sound_config (domain, install_media);
-- 
GitLab

